---
name: bank-account-analysis
description: >
  ניתוח חשבון בנק ומתן תובנות פיננסיות מקיפות בעברית.
  להפעיל כשהמשתמש מבקש: ניתוח חשבון בנק, ניתוח דף חשבון, ניתוח הוצאות,
  בדיקת תזרים מזומנים, ניתוח פיננסי, בדיקה פיננסית, ניתוח דפי בנק,
  ניתוח כרטיס אשראי, "תנתח לי את החשבון", "איפה הכסף שלי הולך",
  "עזור לי להבין את ההוצאות", או כל בקשה הקשורה לניתוח נתונים פיננסיים אישיים.
  תומך בקבצי Excel/CSV מבנקים ישראליים (פועלים, לאומי, דיסקונט, מזרחי-טפחות,
  הבינלאומי, ירושלים, וואן זירו) ומחברות כרטיסי אשראי (ויזה כאל, ישראכארט, מקס).
  הפלט הוא דוח PDF מקצועי בעברית עם גרפים ותובנות.
---

# ניתוח חשבון בנק - Bank Account Analysis

## סקירה כללית

סקיל לניתוח נתונים פיננסיים מחשבונות בנק וכרטיסי אשראי ישראליים.
המשתמש מעלה קבצי Excel/CSV, הסקיל מנתח ומייצר דוח PDF מקצועי בעברית.

## תהליך עבודה

```
1. קליטת נתונים → זיהוי פורמט הבנק ופרסור
2. ניקוי ונרמול → המרה למבנה אחיד
3. ניתוח → הרצת 8 מודולי ניתוח
4. יצירת דוח → PDF בעברית עם גרפים ותובנות
```

### שלב 1: קליטת נתונים

לקרוא את references/bank-formats.md לזיהוי פורמט הקובץ.

**בקשת קבצים מהמשתמש:**
```
שלום! אני כאן כדי לנתח את החשבון שלך ולתת לך תמונה ברורה של המצב הפיננסי.

אנא העלה את קבצי ה-Excel או CSV של דפי החשבון שלך.
נתמך בכל הבנקים וחברות האשראי בישראל.

טיפ: ככל שתעלה יותר חודשים, כך הניתוח יהיה מדויק יותר.
```

**זיהוי אוטומטי:** בדוק את שמות העמודות, שם הגיליון, ומבנה הקובץ כדי לזהות את הבנק.
ראה references/bank-formats.md למיפוי מלא של כל פורמט.

### שלב 2: ניקוי ונרמול

להמיר כל פורמט למבנה אחיד:

```python
# מבנה נתונים אחיד לכל טרנזקציה
{
    "date": "YYYY-MM-DD",        # תאריך
    "description": str,           # תיאור הפעולה
    "amount": float,              # סכום (חיובי=הכנסה, שלילי=הוצאה)
    "balance": float | None,      # יתרה (אם זמין)
    "category": str,              # קטגוריה (מזוהה אוטומטית)
    "source": str,                # שם הבנק/כרטיס
    "type": "bank" | "credit"     # סוג מקור
}
```

**כללי ניקוי:**
- להסיר שורות ריקות ושורות סיכום
- לנרמל תאריכים ל-YYYY-MM-DD
- להמיר סכומים ל-float (להסיר פסיקים, סימני ₪)
- לזהות ולסמן כפילויות בין חשבון בנק לכרטיס אשראי

### שלב 3: ניתוח

להריץ את כל 8 מודולי הניתוח. ראה references/analysis-guide.md למתודולוגיה מפורטת.

**מודולי ניתוח (לפי סדר):**

| # | מודול | תיאור |
|---|-------|-------|
| 1 | סיכום פיננסי | הכנסות מול הוצאות, יתרה ממוצעת |
| 2 | פילוח הוצאות | חלוקה ל-15+ קטגוריות ישראליות |
| 3 | מגמות חודשיות | השוואה חודש-על-חודש, עונתיות |
| 4 | הוראות קבע ומנויים | זיהוי תשלומים חוזרים |
| 5 | זיהוי חריגות | הוצאות חריגות ביחס להיסטוריה |
| 6 | פוטנציאל חיסכון | הזדמנויות לחסוך כסף |
| 7 | תחזית תזרים | צפי ל-3 חודשים קדימה |
| 8 | ציון בריאות פיננסית | ציון 0-100 עם פירוט |

**התאמה לקהל יעד:**
- אם רוב ההכנסות ממשכורת אחת → פרטי, להדגיש חיסכון וניהול הוצאות
- אם יש הכנסות ממספר מקורות / חשבוניות → עצמאי, להדגיש תזרים ומיסוי
- אם יש תנועות עסקיות גבוהות → עסק, להדגיש רווחיות ויעילות תפעולית

### שלב 4: יצירת דוח PDF

להריץ את scripts/generate_report.py עם הנתונים המנותחים.

**מבנה הדוח:**
1. עמוד שער עם שם המשתמש ותאריך
2. תקציר מנהלים - 5 תובנות מרכזיות
3. סיכום פיננסי עם גרפים
4. פילוח הוצאות (פאי צ'ארט + טבלה)
5. מגמות חודשיות (גרף קווי)
6. הוראות קבע ומנויים
7. חריגות והתראות
8. פוטנציאל חיסכון - המלצות קונקרטיות עם סכומים
9. תחזית תזרים מזומנים
10. ציון בריאות פיננסית עם פירוט

**חשוב:**
- כל הטקסט בעברית, RTL
- לעגל סכומים לשקלים שלמים בטקסט, לאגורות בטבלאות
- להשתמש בצבעים: ירוק להכנסות/חיובי, אדום להוצאות/שלילי
- לוודא שהפונט תומך בעברית (להשתמש ב-DejaVu או להתקין פונט עברי)

## הערות חשובות

- **פרטיות:** לא לשמור נתונים פיננסיים מעבר לשיחה הנוכחית
- **אחריות:** להוסיף disclaimer שזה ניתוח אוטומטי ולא ייעוץ פיננסי מקצועי
- **שגיאות:** אם הפורמט לא מזוהה, לבקש מהמשתמש לציין את שם הבנק ולהציג דוגמת שורות
